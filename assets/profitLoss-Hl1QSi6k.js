import{D as E}from"./Default-ahg4HoBN.js";import{_ as G}from"./Icon-UKn1fCvv.js";import{_ as J,f as j,c as V,w as M,r as h,o as c,b as d,a as o,t as _,n as H,d as u,l as k,F as S,j as K,z as W,q as X,h as Y,g as Z,p as $,k as ee}from"./index-OJ4HbseC.js";import{u as te}from"./projects-hmEVCyR7.js";import{u as le}from"./products-UwryS_EH.js";import{u as oe}from"./brands-u_t2IAgd.js";import{u as se}from"./quotations-v3aodYH0.js";import{u as ae}from"./vendors-aHvi7bvq.js";import{u as re}from"./profits-leSWX18_.js";import{I as ie}from"./InputField-NCGauYrP.js";import{M as ne}from"./MenuCard-tcyqHu7M.js";import{B as ce}from"./ButtonLink-kgtRdJKR.js";import{B as de}from"./Button-48Hn7IAn.js";import{L as pe}from"./Loading-GwpIGf7q.js";import{s as ue}from"./default.css_vue_type_style_index_0_src_true_lang-kph5qaYg.js";import{D as me}from"./DataTable-GYmmJ4Rb.js";import{M as _e}from"./Modal-IcDP2JNq.js";import{T as he}from"./TextArea-e1YJeoY1.js";import{T as fe}from"./TextCurrency-ohPxxfvZ.js";import{S as ge}from"./Stepper-KNZiaBI8.js";import"./Pagination-YviDLsFE.js";te();const D=le(),A=oe(),F=se(),x=ae(),be=re(),ve={components:{TextCurrency:fe,Default:E,Icon:G,MenuCard:ne,ButtonLink:ce,Button:de,Loading:pe,InputField:ie,DataTable:me,Modal:_e,Multiselect:ue,TextArea:he,Stepper:ge},data(){return{data:j(F.dataDetail),loading:!1,disablePIC:!1,optionVendor:[],plModel:{quotation_id:this.$route.params.id,profitAndLossItem:[]},stepper_menu:[{label:"QT",complete:!0,link:""},{label:"PL",complete:!0,link:""},{label:"SO",complete:!1,link:""},{label:"PO",complete:!1,link:""},{label:"RG",complete:!1,link:""},{label:"DO",complete:!1,link:""},{label:"INV",complete:!1,link:""}],listQuotation:j(F.data_quotations),modelPL:{profitAndLossItem:[]},uomOpt:[{label:"pcs",value:"pcs"},{label:"pack",value:"pack"},{label:"unit",value:"unit"}],term_opt:[{label:"--pilih--"},{label:"CBD"},{label:"COD"},{label:"DP"}],leadtime_opt:[{label:"--pilih--"},{label:"Indent"},{label:"Ready"}],formFields:[]}},methods:{async submitForm(){await this.mappingData();let e=this.plModel.cogs_price_service.replace(/[^\d]/g,"");this.plModel.cogs_price_service=await parseInt(e);let t=await this.plModel.cogs_price_maintenance.replace(/[^\d]/g,"");this.plModel.cogs_price_maintenance=await parseInt(t);let a=await this.plModel.selling_price_service.replace(/[^\d]/g,"");this.plModel.selling_price_service=await parseInt(a);let p=await this.plModel.selling_price_maintenance.replace(/[^\d]/g,"");this.plModel.selling_price_maintenance=await parseInt(p),console.log(this.plModel),be.PostData(this.plModel)},mappingData(){let e=this.formFields.map(l=>l.map(r=>({[r.name]:r.value}))),t=[];for(let l in e)for(let r in e[l])t.push(e[l][r]);const a=[];for(const l of t)for(const r in l){const g=r.match(/\d+/),b=g?g[0]:"",v=r.replace(/\d+$/,"");a[b]=a[b]||{},a[b][v]=l[r]}const p=a.filter(l=>Object.keys(l).length>=0);for(let l in p){let r=p[l].unit_cogs_price.replace(/[^\d]/g,""),g=p[l].unit_selling_price.replace(/[^\d]/g,"");p[l].product_number=p[l].product_number.value,p[l].unit_cogs_price=parseInt(r),p[l].unit_selling_price=parseInt(g)}this.plModel.profitAndLossItem=[],this.plModel.profitAndLossItem.push(...p)},async optionVendorVal(e){return await x.dataPICByid.map(t=>({value:t.vendor_pic_id,label:t.contact_name}))},async giveOptPIC(e,t){let a=await this.formFields[e][t].value;await x.getPICById(a)},async Vendor(e){return await x.Search(e),await x.dataSearch.map(t=>({value:t.vendor_id,label:t.vendor_name}))},filterJsonArray(e,t){return e.filter(a=>a.customer_id.toLowerCase().includes(t.toLowerCase()))},async VendorPIC(e,t){return console.log(t),{value:"1",label:"1"}},formatInput2(e,t){console.log(e);let a=e.replace(/\D/g,"").replace(/^0+/,"");if(a===""){this.inputValue="";return}t=="sph"?(this.plModel.selling_price_hardware=a,this.plModel.selling_price_hardware=new Intl.NumberFormat("id-ID").format(parseInt(a))):t=="cps"?(this.plModel.cogs_price_service=a,this.plModel.cogs_price_service=new Intl.NumberFormat("id-ID").format(parseInt(a))):t=="sps"?(this.plModel.selling_price_service=a,this.plModel.selling_price_service=new Intl.NumberFormat("id-ID").format(parseInt(a))):t=="cpm"?(this.plModel.cogs_price_maintenance=a,this.plModel.cogs_price_maintenance=new Intl.NumberFormat("id-ID").format(parseInt(a))):t=="spm"&&(this.plModel.selling_price_maintenance=a,this.plModel.selling_price_maintenance=new Intl.NumberFormat("id-ID").format(parseInt(a)))},formatInput(e,t){console.log(e);let a=e.replace(/\D/g,"").replace(/^0+/,"");a!==""&&(t.value=new Intl.NumberFormat("id-ID").format(parseInt(a)))},async Product(e){return await D.Search(e),this.products=D.dataSearch,await D.dataSearch.map(t=>({value:t.product_number,label:t.product_number}))},async Brands(e){return await A.Search(e),await A.dataSearch.map(t=>({value:t.brand_name,label:t.brand_name}))},formatPrice(e){return(e/1).toFixed(2).replace(".",",").toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")},formatCurrency(e){return isNaN(this.items_model.unit_price)||(this.items_model.unit_price=new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(this.items_model.unit_price)),""},async searchArray(e,t,a){let p=await e.find(l=>l[t]===a);return console.log(p),p},async fillDesc(e,t){console.log(this.formFields[e][t].value),console.log(this.products);let a=await this.searchArray(this.products,"product_number",this.formFields[e][t].value.value);console.log(a),a==null?(this.formFields[e][3].label="product not exist! need  select brand",this.formFields[e][3].disable=!1):(this.formFields[e][3].value="",this.formFields[e][4].value=a.product_description,this.formFields[e][3].label="product exist! not need brand",this.formFields[e][3].disable=!0),console.log(this.formFields[e][1])},addFormField(){const e=[{name:"vendor_id"+(this.formFields.length+1),label:"Vendor ",type:"vendor",value:""},{name:"vendor_pic_id"+(this.formFields.length+1),label:"Vendor PIC",type:"vendor_pic",value:""},{name:"product_number"+(this.formFields.length+1),label:"product number ",type:"product",value:""},{name:"brand_name"+(this.formFields.length+1),label:"Select Product First ",type:"brand",value:"",disable:!0},{name:"description"+(this.formFields.length+1),label:"description ",type:"text",value:""},{name:"quantity"+(this.formFields.length+1),label:"quantity ",type:"number",value:""},{name:"uom"+(this.formFields.length+1),label:"uom ",type:"select",options:this.uomOpt,value:""},{name:"unit_cogs_price"+(this.formFields.length+1),label:"unit cogs price ",type:"currency",value:""},{name:"unit_selling_price"+(this.formFields.length+1),label:"unit selling price ",type:"currency",value:""},{name:"note"+(this.formFields.length+1),label:"note",type:"text",value:""}];this.formFields.push(e)},exitingItems(){for(let e in this.data.quotation_items)this.addFormField(),this.formFields[e][2].value={value:this.data.quotation_items[e].product.product_number,label:this.data.quotation_items[e].product.product_number},this.formFields[e][3].disable=!0,this.formFields[e][4].value=this.data.quotation_items[e].description,this.formFields[e][5].value=this.data.quotation_items[e].quantity,this.formFields[e][6].value=this.data.quotation_items[e].uom,this.formFields[e][8].value=this.data.quotation_items[e].unit_price.toLocaleString("id-ID");console.log(this.formFields)}},async mounted(){},async created(){let e=await this.$route.params.id;console.log(e),this.loading=!0,await F.getById(e),this.data=await F.dataDetail,console.log(this.data),this.exitingItems(),console.log(this.formFields),this.loading=!1}},m=e=>($("data-v-a1cab953"),e=e(),ee(),e),ye={class:"flex gap-5"},we={class:"px-20 py-10 w-full flex justify-center items-center"},Ie={class:"w-full mt-10 bg-white shadow-lg rounded-lg px-5 py-5"},Ve={class:"grid grid-cols-3 gap-5"},Fe={class:"bg-white shadow-lg px-5 py-5 rounded-lg grid grid-rows-5 gap-1"},xe=m(()=>o("h1",{class:"border-b h-fit text-slate-700"},"Details",-1)),Me={class:"flex"},ke=m(()=>o("h1",{class:"capitalize w-32"},"customer name",-1)),Se={class:"flex"},De=m(()=>o("h1",{class:"capitalize w-32"},"phone",-1)),Ce={class:"flex"},Pe=m(()=>o("h1",{class:"capitalize w-32"},"Billing",-1)),Be={class:"flex"},Le=m(()=>o("h1",{class:"capitalize w-32"},"shipping",-1)),qe={class:"bg-white shadow-lg px-5 py-5 rounded-lg grid grid-rows-5 gap-1"},Ue=m(()=>o("h1",{class:"border-b text-slate-700 h-fit"},"Contact",-1)),Ne={class:"flex"},ze=m(()=>o("h1",{class:"capitalize w-32"},"contact name",-1)),je={class:"flex"},Ae=m(()=>o("h1",{class:"capitalize w-32"},"phone",-1)),Oe={class:"flex"},Te=m(()=>o("h1",{class:"capitalize w-32"},"email",-1)),Qe=["href"],Re={class:"bg-white shadow-lg px-5 py-5 rounded-lg gap-1"},Ee=m(()=>o("h1",{class:"border-b h-fit text-slate-700 h-fit"},"Quotation Number",-1)),Ge={class:"flex justify-center h-full items-center"},Je={class:"text-5xl text-center text-xl"},He={class:"w-full bg-white px-5 py-5 mt-10"},Ke={class:"grid grid-cols-3 gap-3"},We={id:"vendor-pic",class:"mt-5"},Xe={class:"px-5 text-slate-700 mt-5 py-4 rounded border"},Ye={class:"grid grid-cols-3 rounded-lg gap-3 px-2 border pb-3 mt-5"},Ze={key:0,class:"px-5 py-3 border rounded-lg w-full h-fit"},$e={key:1,class:"px-5 py-3 border rounded-lg w-full h-fit"},et={key:2,class:"px-5 py-3 border rounded-lg w-full h-fit"},tt={key:3,class:"px-5 py-3 border rounded-lg w-full h-fit"},lt={key:4,class:"relative rounded px-2 py-2 border"},ot=m(()=>o("label",{class:"absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-white dark:bg-gray-900 px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:dark:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto start-1 capitalize"},"uom",-1)),st=["onUpdate:modelValue","id"],at=["value"],rt={class:"flex justify-end mt-2"};function it(e,t,a,p,l,r){const g=h("Loading"),b=h("ButtonLink"),v=h("Button"),O=h("MenuCard"),T=h("Stepper"),f=h("InputField"),w=h("Multiselect"),Q=h("Default");return l.loading?(c(),V(g,{key:0})):(c(),V(Q,{key:1},{default:M(()=>{var C,P,B,L,q,U,N,z;return[d(O,{menuLabel:"Profit & Loss"},{default:M(()=>[o("div",ye,[d(b,{type:"secondary",size:"small",icon_name:"ArrowBigLeft",icon_position:"left",link:!0,to:"/quotation/detail/"+l.data.quotation_id},null,8,["to"]),d(v,{type:"success",onClick:r.submitForm,icon_position:"center",size:"small",icon_name:"Save"},null,8,["onClick"])])]),_:1}),o("div",we,[d(T,{menu:l.stepper_menu},null,8,["menu"])]),o("div",Ie,[o("div",Ve,[o("div",Fe,[xe,o("div",Me,[ke,o("p",null,":  "+_((C=l.data.customer)==null?void 0:C.customer_name),1)]),o("div",Se,[De,o("p",null,":  "+_((P=l.data.customer)==null?void 0:P.telephone),1)]),o("div",Ce,[Pe,o("p",null,":  "+_((B=l.data.customer)==null?void 0:B.customer_billing_address),1)]),o("div",Be,[Le,o("p",null,":  "+_((L=l.data.customer)==null?void 0:L.customer_shipping_address),1)])]),o("div",qe,[Ue,o("div",Ne,[ze,o("p",null,":  "+_((q=l.data.customer_pic)==null?void 0:q.contact_name),1)]),o("div",je,[Ae,o("p",null,":  "+_((U=l.data.customer_pic)==null?void 0:U.mobile_phone),1)]),o("div",Oe,[Te,o("p",null,":  "+_((N=l.data.customer_pic)==null?void 0:N.email),1)]),o("a",{href:"https://wa.me/"+((z=l.data.customer_pic)==null?void 0:z.mobile_phone),target:"_blank",class:"bg-green-600 flex justify-center rounded-full items-center text-white py-2"},"open whatsapp",8,Qe)]),o("div",Re,[Ee,o("div",Ge,[o("h1",Je,_(l.data.quotation_number),1)])])])]),o("div",He,[o("div",Ke,[d(f,{modelValue:l.plModel.cust_po_number,"onUpdate:modelValue":t[0]||(t[0]=n=>l.plModel.cust_po_number=n),type:"text",class:"w-full",placeholder:"customer PO number"},null,8,["modelValue"]),d(f,{modelValue:l.plModel.cogs_price_service,"onUpdate:modelValue":t[1]||(t[1]=n=>l.plModel.cogs_price_service=n),onInput:t[2]||(t[2]=n=>r.formatInput2(l.plModel.cogs_price_service,"cps")),type:"text",class:"w-full",placeholder:"cogs price service"},null,8,["modelValue"]),d(f,{modelValue:l.plModel.selling_price_service,"onUpdate:modelValue":t[3]||(t[3]=n=>l.plModel.selling_price_service=n),onInput:t[4]||(t[4]=n=>r.formatInput2(l.plModel.selling_price_service,"sps")),type:"text",class:"w-full",placeholder:"selling price service"},null,8,["modelValue"]),d(f,{modelValue:l.plModel.cogs_price_maintenance,"onUpdate:modelValue":t[5]||(t[5]=n=>l.plModel.cogs_price_maintenance=n),onInput:t[6]||(t[6]=n=>r.formatInput2(l.plModel.cogs_price_maintenance,"cpm")),type:"text",class:"w-full",placeholder:"cogs price maintenance"},null,8,["modelValue"]),d(f,{modelValue:l.plModel.selling_price_maintenance,"onUpdate:modelValue":t[7]||(t[7]=n=>l.plModel.selling_price_maintenance=n),onInput:t[8]||(t[8]=n=>r.formatInput2(l.plModel.selling_price_maintenance,"spm")),type:"text",class:"w-full",placeholder:"selling price maintenance"},null,8,["modelValue"])]),o("div",We,[o("form",{onSubmit:t[9]||(t[9]=H(()=>{},["prevent"]))},[(c(!0),u(S,null,k(l.formFields,(n,y)=>(c(),u("div",{key:y},[o("div",Xe,[o("h1",null,"Item "+_(y+1),1)]),o("div",Ye,[(c(!0),u(S,null,k(n,(s,I)=>(c(),u("div",{key:I,class:W(["mt-5 w-full",I>8?"col-span-3":""])},[s.type=="vendor"?(c(),u("div",Ze,[d(w,{placeholder:"Select Vendor",modelValue:s.value,"onUpdate:modelValue":i=>s.value=i,id:s.name,options:r.Vendor,"filter-results":!1,"resolve-on-load":!1,delay:0,searchable:!0,onSelect:i=>r.giveOptPIC(y,I),class:"multiselect-blue w-full","close-on-select":!0},null,8,["modelValue","onUpdate:modelValue","id","options","onSelect"])])):s.type==="vendor_pic"?(c(),u("div",$e,[d(w,{placeholder:"Select Vendor PIC",id:s.name,modelValue:s.value,"onUpdate:modelValue":i=>s.value=i,options:r.optionVendorVal,"filter-results":!1,"resolve-on-load":!1,delay:0,searchable:!0,class:"multiselect-blue w-full","close-on-select":!0},null,8,["id","modelValue","onUpdate:modelValue","options"])])):s.type==="product"?(c(),u("div",et,[d(w,{placeholder:"Select Product",id:s.name,modelValue:s.value,"onUpdate:modelValue":i=>s.value=i,options:r.Product,"filter-results":!1,object:!0,autocomplete:"false","resolve-on-load":!1,delay:4,searchable:!0,"create-option":!0,class:"multiselect-blue w-full",onSelect:i=>r.fillDesc(y,I)},null,8,["id","modelValue","onUpdate:modelValue","options","onSelect"])])):s.type==="brand"?(c(),u("div",tt,[d(w,{placeholder:s.label,modelValue:s.value,"onUpdate:modelValue":i=>s.value=i,object:!0,disabled:s.disable,options:r.Brands,"filter-results":!1,"resolve-on-load":!1,delay:0,searchable:!0,class:"multiselect-blue mt-10 w-full h-fit","close-on-select":!0},null,8,["placeholder","modelValue","onUpdate:modelValue","disabled","options"])])):s.type==="select"?(c(),u("div",lt,[ot,Y(o("select",{"onUpdate:modelValue":i=>s.value=i,id:s.name,class:"block px-2.5 pb-2.5 pt-5 text-sm w-full text-sm text-gray-700 bg-transparent rounded-lg border-1 border-gray-300 appearance-none dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer",placeholder:" "},[(c(!0),u(S,null,k(s.options,(i,R)=>(c(),u("option",{key:R,value:i.value},_(i.label),9,at))),128))],8,st),[[X,s.value]])])):s.type=="number"||s.type=="text"?(c(),V(f,{key:5,type:s.type,class:"w-full",id:s.name,name:s.name,placeholder:s.label,modelValue:s.value,"onUpdate:modelValue":i=>s.value=i},null,8,["type","id","name","placeholder","modelValue","onUpdate:modelValue"])):s.type=="currency"?(c(),V(f,{key:6,type:"text",onInput:i=>r.formatInput(s.value,s),class:"w-full",id:s.name,name:s.name,placeholder:s.label,modelValue:s.value,"onUpdate:modelValue":i=>s.value=i},null,8,["onInput","id","name","placeholder","modelValue","onUpdate:modelValue"])):Z("",!0)],2))),128))]),o("div",rt,[d(v,{type:"danger",icon_name:"Trash",class:"h-fit",icon_position:"center",onClick:s=>e.deleteFormField(y)},null,8,["onClick"])])]))),128))],32),d(v,{type:"success",class:"w-fit mt-10",size:"small",icon_name:"Plus",icon_position:"left",onClick:r.addFormField},{default:M(()=>[K(" Add Items")]),_:1},8,["onClick"])])])]}),_:1}))}const Dt=J(ve,[["render",it],["__scopeId","data-v-a1cab953"]]);export{Dt as default};
