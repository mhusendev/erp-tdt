import{D as N}from"./Default-SnYXce0r.js";import{_ as A}from"./Icon-Jn8JfFO8.js";import{_ as F,f as M,c as C,w as g,r as _,o as d,b as c,a as s,j as y,d as v,l as P,F as j,t as p,s as V,h as Q,p as z,k as R}from"./index-zNN2oSXV.js";import{u as E}from"./projects-tobxMXGL.js";import{u as $}from"./progress-BH9j7L3D.js";import{u as J}from"./quotations-PJnJ-Ljd.js";import{u as U}from"./purchase-orders-GuxSbtAN.js";import{u as q}from"./profits-MG7iqzmv.js";import{u as G}from"./sales-orders-QhQKUHa6.js";import{u as H}from"./receive-goods-wwosUj76.js";import{u as Y}from"./delivery-order-v6aM_l6Z.js";import{u as K}from"./invoice-ntijyz4O.js";import{I as W}from"./InputField-8O8zhtvs.js";import{M as X}from"./MenuCard-si4DgcMV.js";import{B as Z}from"./ButtonLink-lOTu3OkL.js";import{B as ee}from"./Button-Nlr5QnjH.js";import{L as te}from"./Loading-SVqbFMk-.js";import{s as se}from"./default.css_vue_type_style_index_0_src_true_lang-mMztfpja.js";import{D as oe}from"./DataTable-YIr7e0Qr.js";import{M as ie}from"./Modal-Egd1_BWl.js";import{T as ae}from"./TextArea-pgYTDawa.js";import{T as re}from"./TextCurrency-RLa14qax.js";import{S as le}from"./Stepper-nks7oq9_.js";import"./Pagination-niETu5eI.js";const T=$();E();J();const ne=U();q();G();H();const L=Y(),de=K();let n=[];const ce={components:{TextCurrency:re,Default:N,Icon:A,MenuCard:X,ButtonLink:Z,Button:ee,Loading:te,InputField:W,DataTable:oe,Modal:ie,Multiselect:se,TextArea:ae,Stepper:le},data(){return{vendorDOModel:{},body:[],detailOrder:{},temp_data_invoice:[],manualChecked:!0,aprove:!1,stepper_menu:[{label:"QT",complete:!1,link:"/quotation/detail/"},{label:"PL",complete:!1,link:"/profit-and-loss/detail/"},{label:"SO",complete:!1,link:"/sales-order/detail/"},{label:"PO",complete:!1,link:"/purchase-order/"},{label:"RG",complete:!1,link:"/receive-list/"},{label:"DO",complete:!1,link:"/delivery-order/"},{label:"IV",complete:!1,link:"/invoice/so/"}],file1:null,file2:null,dataPO:{},dataDO:[],loading:!1,isModalOpen:!1,so_id:"",formserial:M(""),indexSerial:"",dataSN:[],doModel:{stock_out_items:[]}}},methods:{async updateStepper(){var o;let e=JSON.parse(localStorage.getItem("progress"));await T.getData(e[0].idQT);let t=await T.data_progress;t&&(o=t[1])!=null&&o.status&&(this.isPLexist=!0),await localStorage.setItem("progress",JSON.stringify(t))},async setStepper(){var t,o,r,i,a,h,m,x,f,w,k,D,b,O;let e=await JSON.parse(localStorage.getItem("progress"));e&&(this.stepper_menu[0].complete=(t=e[0])==null?void 0:t.status,this.stepper_menu[0].link=this.stepper_menu[0].link+((o=e[0])==null?void 0:o.idQT),this.stepper_menu[1].complete=(r=e[1])==null?void 0:r.status,this.stepper_menu[1].link=this.stepper_menu[1].link+((i=e[1])==null?void 0:i.idQT),this.stepper_menu[2].complete=(a=e[2])==null?void 0:a.status,this.stepper_menu[2].link=this.stepper_menu[2].link+((h=e[2])==null?void 0:h.idPL),this.stepper_menu[3].complete=(m=e[3])==null?void 0:m.status,this.stepper_menu[3].link=this.stepper_menu[3].link+((x=e[3])==null?void 0:x.idQT),this.stepper_menu[4].complete=(f=e[4])==null?void 0:f.status,this.stepper_menu[4].link=this.stepper_menu[4].link+((w=e[4])==null?void 0:w.idQT),this.stepper_menu[5].complete=(k=e[5])==null?void 0:k.status,this.stepper_menu[5].link=this.stepper_menu[5].link+((D=e[5])==null?void 0:D.idSO),this.stepper_menu[6].complete=(b=e[6])==null?void 0:b.status,this.stepper_menu[6].link=this.stepper_menu[6].link+((O=e[6])==null?void 0:O.idSO))},formatDateTime(e){const t=new Date(e),o=t.getDate().toString().padStart(2,"0"),r=(t.getMonth()+1).toString().padStart(2,"0"),i=t.getFullYear().toString().slice(-2),a=t.getHours().toString().padStart(2,"0"),h=t.getMinutes().toString().padStart(2,"0"),m=t.getSeconds().toString().padStart(2,"0");return`${o}/${r}/${i} ${a}:${h}:${m}`},formatCurrency(e){return e?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(e):"Rp.0"},handleFileChange1(e){this.file1=e.target.files[0]},handleFileChange2(e){this.file2=e.target.files[0]},async filterDataforTable(){const e=["createdAt","updatedAt","history","vendor_id","quotation_id","vendor_name","vendor_pic_name","vendor_pic_email","vendor_pic_id","inv_vendor_attachment","so_id","project_id","receive_type","po_id"],t=await ne.data_po.map(o=>Object.fromEntries(Object.entries(o).filter(([i])=>!e.includes(i))));for(let o in t)t[o].total=this.formatCurrency(t[o].total);return t},ModalSerial(e){this.isModalOpen=!0,this.indexSerial=e,console.log(e),n=[],console.log(n)},ScanSerial(e){if(this.formserial!=="")if(this.dataPO.purchaseOrderItems[e].serial_numbers){n=this.dataPO.purchaseOrderItems[e].serial_numbers,n.push(this.formserial);let t=n;this.dataPO.purchaseOrderItems[e].serial_numbers=t}else{n.push(this.formserial);let t=n;this.dataPO.purchaseOrderItems[e].serial_numbers=t}this.formserial=M(""),console.log(this.dataPO)},removeItem(e,t){console.log(this.dataPO.purchaseOrderItems[this.indexSerial].serial_numbers),this.dataPO.purchaseOrderItems[this.indexSerial].serial_numbers=this.dataPO.purchaseOrderItems[this.indexSerial].serial_numbers.filter(o=>o!==e)},EnterSerial(e){if(this.formserial!=="")if(this.dataPO.purchaseOrderItems[e].serial_numbers){n=this.dataPO.purchaseOrderItems[e].serial_numbers,n.push(this.formserial);let t=n;this.dataPO.purchaseOrderItems[e].serial_numbers=t}else{n.push(this.formserial);let t=n;this.dataPO.purchaseOrderItems[e].serial_numbers=t}this.formserial=M(""),console.log(this.dataPO)},async SaveData(){let e=[];for(let o in this.temp_data_invoice)for(let r in this.temp_data_invoice[o].delivery_items)this.temp_data_invoice[o].delivery_items[r].selectedAll&&e.push(this.temp_data_invoice[o].delivery_items[r].doItem_id);let t={doItems_id:e,so_id:this.$route.params.id};de.PostData(t),this.updateStepper(),this.setStepper()},async mappingForSave(e){return(await e.map(o=>{const r=o.receive_items.filter(i=>i.receive_item_serials_json.some(a=>a.selected)).map(i=>({product_id:i.product_id,product_number:i.product_number,uom:i.uom,serial_numbers:i.receive_item_serials_json.filter(a=>a.selected).map(a=>a.serial)}));return{po_id:o.po_id,items_out:r}})).filter(function(o){return o.items_out.length>0})},ModalShow(e){console.log(e),this.isModalOpen=!0,this.detailOrder=e},closeModal(){this.isModalOpen=!1},async mappingData(){},handleSelectAll(e,t){if(console.log(e),e.selectedAll)for(let o in e.receive_item_serials_json)e.receive_item_serials_json[o].selected=!0;else for(let o in e.receive_item_serials_json)e.receive_item_serials_json[o].selected=!1},selectedSingle(e,t,o,r){t.selected||(e.selectedAll=!1)},replaceObjectById(e,t,o){var r=!1,i=e.map(function(a){return a.rg_id===t?(r=!0,o):a});return r||i.push(o),i},SaveDataTotemp(){this.temp_data_invoice.length!=0?this.temp_data_invoice=this.replaceObjectById(this.temp_data_invoice,this.detailOrder.rg_id,this.detailOrder):this.temp_data_invoice.push(this.detailOrder),console.log(this.temp_data_invoice),this.isModalOpen=!1}},async created(){this.loading=!0,await this.updateStepper(),await this.setStepper(),await L.listSO(this.$route.params.id),this.dataDO=await L.lisBy_so;for(let e in this.dataDO)for(let t in this.dataDO[e].delivery_items)this.dataDO[e].delivery_items[t].selectedAll=!1;this.so_id=this.$route.params.id,this.loading=!1,console.log(this.dataDO)}},u=e=>(z("data-v-0995b363"),e=e(),R(),e),pe={class:"flex gap-5"},ue={class:"bg-white px-5 py-5 flex justify-between mr-10"},me=u(()=>s("div",null,[s("h1",{class:"font-bold text-lg"},"# Select Product items for Invoice")],-1)),_e={class:"h-[700px] px-10 py-10 w-[1000px] bg-slate-200 overflow-y-auto"},he={class:"flex justify-center items-center gap-3"},fe={class:"w-full"},ge={class:"bg-gray-100 px-5 py-2 flex gap-3"},ye=["onUpdate:modelValue","onChange"],ve=u(()=>s("b",null,"#",-1)),be={class:"bg-white rounded px-5 py-5 shadow-md flex justify-between gap-5"},Oe={class:"w-full bg-white py-3 shadow px-2 rounded"},Se=u(()=>s("b",null,"Part Number #: ",-1)),xe={class:"w-full bg-white py-3 shadow px-2 rounded"},we=u(()=>s("b",null,"UOM #: ",-1)),ke={class:"px-5 py-2"},De=u(()=>s("div",{class:"border-b w-fit px-5 py-2 mt-1"},"Serial Number",-1)),Ie={class:"w-full h-[150px] overflow-y-scroll px-10"},Me={class:"w-full grid grid-cols-3 gap-2 mt-5"},Pe=u(()=>s("div",{class:"flex mt-10 justify-end"},null,-1)),je={class:"px-20 py-10 w-full flex justify-center items-center"},Ce={class:"w-full px-10 py-10 bg-white"},Te={class:"w-full grid grid-cols-2 gap-5 mt-5 bg-white"},Le={class:"w-full"},Be={class:"font-semibold text-lg px-5"},Ne={class:"text-md px-5"},Ae=u(()=>s("b",null,"SO Number #:",-1)),Fe={class:"w-full mt-10"},Ve={class:"flex justify-end"},Qe={class:"relative overflow-x-auto"},ze={class:"w-full text-sm text-left rtl:text-right text-gray-500 mt-2"},Re=u(()=>s("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50"},[s("tr",null,[s("th",{scope:"col",class:"px-6 py-3"}," PO Number "),s("th",{scope:"col",class:"px-6 py-3"}," DO Number "),s("th",{scope:"col",class:"px-6 py-3"}," Status "),s("th",{scope:"col",class:"px-6 py-3"}," # ")])],-1)),Ee={class:"px-6 py-4 text-xs"},$e={class:"mb-2"},Je={class:"px-6 py-4"},Ue={class:"px-6 py-4"},qe={class:"px-6 py-4 flex justify-center"};function Ge(e,t,o,r,i,a){const h=_("Loading"),m=_("ButtonLink"),x=_("MenuCard"),f=_("Button"),w=_("Modal"),k=_("Stepper"),D=_("Default");return i.loading?(d(),C(h,{key:0})):(d(),C(D,{key:1},{default:g(()=>{var b,O;return[c(x,{menuLabel:"List Delivery"},{default:g(()=>[s("div",pe,[c(m,{type:"secondary",size:"small",icon_name:"ArrowLeft",icon_position:"left",to:"/delivery-order/"+i.so_id},null,8,["to"]),c(m,{type:"secondary",size:"small",to:"/invoice/so/"+i.so_id},{default:g(()=>[y(" Invoice ")]),_:1},8,["to"])])]),_:1}),c(w,{show:i.isModalOpen,modalType:"primary",modalLabel:"Product Items ",onCloseModal:a.closeModal,closeModalIcon:!1},{default:g(()=>[s("div",ue,[me,c(f,{type:"success",onClick:t[0]||(t[0]=l=>a.SaveDataTotemp()),class:"w-fit h-fit",icon_position:"left",size:"small",icon_name:"Check"})]),s("div",_e,[s("div",he,[s("div",fe,[(d(!0),v(j,null,P(i.detailOrder.delivery_items,(l,I)=>(d(),v("div",{class:"w-full bg-white shadow-md rounded-lg mb-5",key:I},[s("div",ge,[Q(s("input",{type:"checkbox","onUpdate:modelValue":S=>l.selectedAll=S,onChange:S=>a.handleSelectAll(l,I),class:"form-checkbox h-4 w-4 text-indigo-600 transition duration-150 ease-in-out"},null,40,ye),[[V,l.selectedAll]]),ve]),s("div",be,[s("div",Oe,[Se,y(" "+p(l.product_number),1)]),s("div",xe,[we,y(p(l.uom),1)])]),s("div",ke,[De,s("div",Ie,[s("div",Me,[(d(!0),v(j,null,P(l.delivery_item_serials,(S,B)=>(d(),v("div",{class:"bg-gray-200 px-3 py-2 shadow-md flex gap-3",key:B},p(S),1))),128))])])])]))),128))])]),Pe])]),_:1},8,["show","onCloseModal"]),s("div",je,[c(k,{menu:i.stepper_menu},null,8,["menu"])]),s("div",Ce,[s("div",Te,[s("div",Le,[s("h1",Be,p((b=i.dataDO[0])==null?void 0:b.customer_name),1),s("h1",Ne,[Ae,y(" "+p((O=i.dataDO[0])==null?void 0:O.so_number),1)])])]),s("div",Fe,[s("div",Ve,[c(f,{type:"success",onClick:t[1]||(t[1]=l=>a.SaveData()),class:"w-fit h-fit",icon_position:"left",size:"small",icon_name:"NotepadText"},{default:g(()=>[y(" Make Invoice ")]),_:1})]),s("div",Qe,[s("table",ze,[Re,s("tbody",null,[(d(!0),v(j,null,P(i.dataDO,(l,I)=>(d(),v("tr",{class:"bg-white border-b",key:I},[s("td",Ee,[s("h1",$e,p(l.po_number),1)]),s("td",Je,p(l.do_number),1),s("td",Ue,p(l.doInfo_status),1),s("td",qe,[c(f,{type:"primary",onClick:S=>a.ModalShow(l),class:"w-fit h-fit",icon_position:"left",size:"small",icon_name:"Eye"},{default:g(()=>[y(" Product Items ")]),_:2},1032,["onClick"])])]))),128))])])])])])]}),_:1}))}const yt=F(ce,[["render",Ge],["__scopeId","data-v-0995b363"]]);export{yt as default};
