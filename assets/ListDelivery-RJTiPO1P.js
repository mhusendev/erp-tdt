import{D as L}from"./Default-BQYD8_Ix.js";import{_ as A}from"./Icon-JtKGVolk.js";import{_ as N,f as x,c as I,w as u,r as m,o as d,b as c,a as t,j as h,d as f,l as w,F as S,t as p,s as F,h as V,p as z,k as R}from"./index-jErkSH92.js";import{u as E}from"./projects-jxuxNDd3.js";import{u as $}from"./quotations-T5MJbp8z.js";import{u as U}from"./purchase-orders-hwH3Tjkq.js";import{u as G}from"./profits-rIYum_s1.js";import{u as Q}from"./sales-orders-8keD3WSj.js";import{u as q}from"./receive-goods-C5Lv89cK.js";import{u as H}from"./delivery-order-sCpZJUV8.js";import{u as Y}from"./invoice-7qlS8a67.js";import{I as J}from"./InputField-gaHDi2mc.js";import{M as K}from"./MenuCard-fm8191j7.js";import{B as W}from"./ButtonLink-v4Xigd-7.js";import{B as X}from"./Button-L2bFlQpT.js";import{L as Z}from"./Loading--kz6pXtx.js";import{s as ee}from"./default.css_vue_type_style_index_0_src_true_lang-HReR-_qN.js";import{D as te}from"./DataTable-7BFAAARy.js";import{M as se}from"./Modal-GHy1jzT4.js";import{T as oe}from"./TextArea-xXqy_h2u.js";import{T as ae}from"./TextCurrency-sXabEbdO.js";import{S as ie}from"./Stepper-uSaRgYgb.js";import"./Pagination-yU6GMoj9.js";E();$();const re=U(),le=G();Q();q();const M=H(),ne=Y();let n=[];const de={components:{TextCurrency:ae,Default:L,Icon:A,MenuCard:K,ButtonLink:W,Button:X,Loading:Z,InputField:J,DataTable:te,Modal:se,Multiselect:ee,TextArea:oe,Stepper:ie},data(){return{vendorDOModel:{},body:[],detailOrder:{},temp_data_invoice:[],manualChecked:!0,aprove:!1,stepper_menu:[{label:"QT",complete:!0,link:""},{label:"PL",complete:!0,link:""},{label:"SO",complete:!1,link:""},{label:"PO",complete:!1,link:""},{label:"RG",complete:!1,link:""},{label:"DO",complete:!1,link:""},{label:"INV",complete:!1,link:""}],file1:null,file2:null,dataPO:{},dataDO:[],loading:!1,isModalOpen:!1,so_id:"",formserial:x(""),indexSerial:"",dataSN:[],doModel:{stock_out_items:[]}}},methods:{formatDateTime(e){const s=new Date(e),o=s.getDate().toString().padStart(2,"0"),l=(s.getMonth()+1).toString().padStart(2,"0"),a=s.getFullYear().toString().slice(-2),i=s.getHours().toString().padStart(2,"0"),b=s.getMinutes().toString().padStart(2,"0"),y=s.getSeconds().toString().padStart(2,"0");return`${o}/${l}/${a} ${i}:${b}:${y}`},formatCurrency(e){return e?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(e):"Rp.0"},handleFileChange1(e){this.file1=e.target.files[0]},handleFileChange2(e){this.file2=e.target.files[0]},async CheckStepper(){this.aprove=!0,this.stepper_menu[2].complete=!0,this.stepper_menu[3].complete=!0,this.stepper_menu[4].complete=!0,this.stepper_menu[5].complete=!0,this.stepper_menu[2].link="/sales-order/detail/"+le.data_profit.pl_id},async filterDataforTable(){const e=["createdAt","updatedAt","history","vendor_id","quotation_id","vendor_name","vendor_pic_name","vendor_pic_email","vendor_pic_id","inv_vendor_attachment","so_id","project_id","receive_type","po_id"],s=await re.data_po.map(o=>Object.fromEntries(Object.entries(o).filter(([a])=>!e.includes(a))));for(let o in s)s[o].total=this.formatCurrency(s[o].total);return s},ModalSerial(e){this.isModalOpen=!0,this.indexSerial=e,console.log(e),n=[],console.log(n)},ScanSerial(e){if(this.formserial!=="")if(this.dataPO.purchaseOrderItems[e].serial_numbers){n=this.dataPO.purchaseOrderItems[e].serial_numbers,n.push(this.formserial);let s=n;this.dataPO.purchaseOrderItems[e].serial_numbers=s}else{n.push(this.formserial);let s=n;this.dataPO.purchaseOrderItems[e].serial_numbers=s}this.formserial=x(""),console.log(this.dataPO)},removeItem(e,s){console.log(this.dataPO.purchaseOrderItems[this.indexSerial].serial_numbers),this.dataPO.purchaseOrderItems[this.indexSerial].serial_numbers=this.dataPO.purchaseOrderItems[this.indexSerial].serial_numbers.filter(o=>o!==e)},EnterSerial(e){if(this.formserial!=="")if(this.dataPO.purchaseOrderItems[e].serial_numbers){n=this.dataPO.purchaseOrderItems[e].serial_numbers,n.push(this.formserial);let s=n;this.dataPO.purchaseOrderItems[e].serial_numbers=s}else{n.push(this.formserial);let s=n;this.dataPO.purchaseOrderItems[e].serial_numbers=s}this.formserial=x(""),console.log(this.dataPO)},async SaveData(){let e=[];for(let o in this.temp_data_invoice)for(let l in this.temp_data_invoice[o].delivery_items)this.temp_data_invoice[o].delivery_items[l].selectedAll&&e.push(this.temp_data_invoice[o].delivery_items[l].doItem_id);let s={doItems_id:e,so_id:this.$route.params.id};ne.PostData(s)},async mappingForSave(e){return(await e.map(o=>{const l=o.receive_items.filter(a=>a.receive_item_serials_json.some(i=>i.selected)).map(a=>({product_id:a.product_id,product_number:a.product_number,uom:a.uom,serial_numbers:a.receive_item_serials_json.filter(i=>i.selected).map(i=>i.serial)}));return{po_id:o.po_id,items_out:l}})).filter(function(o){return o.items_out.length>0})},ModalShow(e){console.log(e),this.isModalOpen=!0,this.detailOrder=e},closeModal(){this.isModalOpen=!1},async mappingData(){},handleSelectAll(e,s){if(console.log(e),e.selectedAll)for(let o in e.receive_item_serials_json)e.receive_item_serials_json[o].selected=!0;else for(let o in e.receive_item_serials_json)e.receive_item_serials_json[o].selected=!1},selectedSingle(e,s,o,l){s.selected||(e.selectedAll=!1)},replaceObjectById(e,s,o){var l=!1,a=e.map(function(i){return i.rg_id===s?(l=!0,o):i});return l||a.push(o),a},SaveDataTotemp(){this.temp_data_invoice.length!=0?this.temp_data_invoice=this.replaceObjectById(this.temp_data_invoice,this.detailOrder.rg_id,this.detailOrder):this.temp_data_invoice.push(this.detailOrder),console.log(this.temp_data_invoice),this.isModalOpen=!1}},async created(){this.loading=!0,await this.CheckStepper(),await M.listSO(this.$route.params.id),this.dataDO=await M.lisBy_so;for(let e in this.dataDO)for(let s in this.dataDO[e].delivery_items)this.dataDO[e].delivery_items[s].selectedAll=!1;this.so_id=this.$route.params.id,this.loading=!1,console.log(this.dataDO)}},_=e=>(z("data-v-f2ee6326"),e=e(),R(),e),ce={class:"flex gap-5"},pe={class:"bg-white px-5 py-5 flex justify-between mr-10"},_e=_(()=>t("div",null,[t("h1",{class:"font-bold text-lg"},"# Select Product items for Invoice")],-1)),me={class:"h-[700px] px-10 py-10 w-[1000px] bg-slate-200 overflow-y-auto"},ue={class:"flex justify-center items-center gap-3"},he={class:"w-full"},fe={class:"bg-gray-100 px-5 py-2 flex gap-3"},ve=["onUpdate:modelValue","onChange"],ye=_(()=>t("b",null,"#",-1)),ge={class:"bg-white rounded px-5 py-5 shadow-md flex justify-between gap-5"},be={class:"w-full bg-white py-3 shadow px-2 rounded"},Oe=_(()=>t("b",null,"Part Number #: ",-1)),xe={class:"w-full bg-white py-3 shadow px-2 rounded"},we=_(()=>t("b",null,"UOM #: ",-1)),Se={class:"px-5 py-2"},De=_(()=>t("div",{class:"border-b w-fit px-5 py-2 mt-1"},"Serial Number",-1)),ke={class:"w-full h-[150px] overflow-y-scroll px-10"},Ie={class:"w-full grid grid-cols-3 gap-2 mt-5"},Me=_(()=>t("div",{class:"flex mt-10 justify-end"},null,-1)),Pe={class:"px-20 py-10 w-full flex justify-center items-center"},Ce={class:"w-full px-10 py-10 bg-white"},je={class:"w-full grid grid-cols-2 gap-5 mt-5 bg-white"},Be={class:"w-full"},Te={class:"font-semibold text-lg px-5"},Le={class:"text-md px-5"},Ae=_(()=>t("b",null,"SO Number #:",-1)),Ne={class:"w-full mt-10"},Fe={class:"flex justify-end"},Ve={class:"relative overflow-x-auto"},ze={class:"w-full text-sm text-left rtl:text-right text-gray-500 mt-2"},Re=_(()=>t("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3"}," PO Number "),t("th",{scope:"col",class:"px-6 py-3"}," DO Number "),t("th",{scope:"col",class:"px-6 py-3"}," Status "),t("th",{scope:"col",class:"px-6 py-3"}," # ")])],-1)),Ee={class:"px-6 py-4 text-xs"},$e={class:"mb-2"},Ue={class:"px-6 py-4"},Ge={class:"px-6 py-4"},Qe={class:"px-6 py-4 flex justify-center"};function qe(e,s,o,l,a,i){const b=m("Loading"),y=m("ButtonLink"),P=m("MenuCard"),O=m("Button"),C=m("Modal"),j=m("Stepper"),B=m("Default");return a.loading?(d(),I(b,{key:0})):(d(),I(B,{key:1},{default:u(()=>{var D,k;return[c(P,{menuLabel:"List Delivery"},{default:u(()=>[t("div",ce,[c(y,{type:"secondary",size:"small",icon_name:"ArrowLeft",icon_position:"left",to:"/delivery-order/"+a.so_id},null,8,["to"]),c(y,{type:"secondary",size:"small",to:"/invoice/so/"+a.so_id},{default:u(()=>[h(" Invoice ")]),_:1},8,["to"])])]),_:1}),c(C,{show:a.isModalOpen,modalType:"primary",modalLabel:"Product Items ",onCloseModal:i.closeModal,closeModalIcon:!1},{default:u(()=>[t("div",pe,[_e,c(O,{type:"success",onClick:s[0]||(s[0]=r=>i.SaveDataTotemp()),class:"w-fit h-fit",icon_position:"left",size:"small",icon_name:"Check"})]),t("div",me,[t("div",ue,[t("div",he,[(d(!0),f(S,null,w(a.detailOrder.delivery_items,(r,g)=>(d(),f("div",{class:"w-full bg-white shadow-md rounded-lg mb-5",key:g},[t("div",fe,[V(t("input",{type:"checkbox","onUpdate:modelValue":v=>r.selectedAll=v,onChange:v=>i.handleSelectAll(r,g),class:"form-checkbox h-4 w-4 text-indigo-600 transition duration-150 ease-in-out"},null,40,ve),[[F,r.selectedAll]]),ye]),t("div",ge,[t("div",be,[Oe,h(" "+p(r.product_number),1)]),t("div",xe,[we,h(p(r.uom),1)])]),t("div",Se,[De,t("div",ke,[t("div",Ie,[(d(!0),f(S,null,w(r.delivery_item_serials,(v,T)=>(d(),f("div",{class:"bg-gray-200 px-3 py-2 shadow-md flex gap-3",key:T},p(v),1))),128))])])])]))),128))])]),Me])]),_:1},8,["show","onCloseModal"]),t("div",Pe,[c(j,{menu:a.stepper_menu},null,8,["menu"])]),t("div",Ce,[t("div",je,[t("div",Be,[t("h1",Te,p((D=a.dataDO[0])==null?void 0:D.customer_name),1),t("h1",Le,[Ae,h(" "+p((k=a.dataDO[0])==null?void 0:k.so_number),1)])])]),t("div",Ne,[t("div",Fe,[c(O,{type:"success",onClick:s[1]||(s[1]=r=>i.SaveData()),class:"w-fit h-fit",icon_position:"left",size:"small",icon_name:"NotepadText"},{default:u(()=>[h(" Make Invoice ")]),_:1})]),t("div",Ve,[t("table",ze,[Re,t("tbody",null,[(d(!0),f(S,null,w(a.dataDO,(r,g)=>(d(),f("tr",{class:"bg-white border-b",key:g},[t("td",Ee,[t("h1",$e,p(r.po_number),1)]),t("td",Ue,p(r.do_number),1),t("td",Ge,p(r.doInfo_status),1),t("td",Qe,[c(O,{type:"primary",onClick:v=>i.ModalShow(r),class:"w-fit h-fit",icon_position:"left",size:"small",icon_name:"Eye"},{default:u(()=>[h(" Product Items ")]),_:2},1032,["onClick"])])]))),128))])])])])])]}),_:1}))}const ft=N(de,[["render",qe],["__scopeId","data-v-f2ee6326"]]);export{ft as default};
