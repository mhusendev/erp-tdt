import{D as A}from"./Default-UzTWWqk9.js";import{_ as F}from"./Icon-rtOuHIS6.js";import{_ as N,f as O,c as I,w as v,r as _,o as d,b as m,a as t,j as g,d as p,l as b,F as k,t as u,s as P,h as C,g as j,p as Q,k as U}from"./index-2Xl9qFv7.js";import{u as $}from"./projects-m_BtDv-_.js";import{u as q}from"./quotations-DO3D_tSp.js";import{u as z}from"./purchase-orders-F54LUs0k.js";import{u as E}from"./profits-DD-uQzfp.js";import{u as H}from"./sales-orders-o2BgRW2k.js";import{u as J}from"./receive-goods-bfRVljC2.js";import{u as Y}from"./delivery-order-ekbGo4IS.js";import{I as K}from"./InputField-eKlKr605.js";import{M as W}from"./MenuCard-Cm1nNJYU.js";import{B as X}from"./ButtonLink-xY7BTdTe.js";import{B as Z}from"./Button-_saYDuqz.js";import{L as ee}from"./Loading-bud4hAA4.js";import{s as te}from"./default.css_vue_type_style_index_0_src_true_lang-U16oWYK-.js";import{D as se}from"./DataTable-yeLKldhm.js";import{M as oe}from"./Modal-ZMIHFB3R.js";import{T as ae}from"./TextArea-KW4ixcr0.js";import{T as ie}from"./TextCurrency-fK0DUXJx.js";import{S as le}from"./Stepper-iYhSeoBN.js";import"./Pagination-9Wn2p13Z.js";$();q();const re=z(),ne=E();H();const T=J(),D=Y();let c=[];const de={components:{TextCurrency:ie,Default:A,Icon:F,MenuCard:W,ButtonLink:X,Button:Z,Loading:ee,InputField:K,DataTable:se,Modal:oe,Multiselect:te,TextArea:ae,Stepper:le},data(){return{vendorDOModel:{},body:[],detailOrder:{},stock_out_temp:[],manualChecked:!0,aprove:!1,stepper_menu:[{label:"QT",complete:!1,link:"/quotation/detail/"},{label:"PL",complete:!1,link:"/profit-and-loss/detail/"},{label:"SO",complete:!1,link:"/sales-order/detail/"},{label:"PO",complete:!1,link:"/purchase-order/"},{label:"RG",complete:!1,link:"/receive-list/"},{label:"DO",complete:!1,link:"/delivery-order/"},{label:"IV",complete:!1,link:"/invoice/so/"}],file1:null,file2:null,dataPO:{},so_id:"",dataRG:[],loading:!1,isModalOpen:!1,formserial:O(""),indexSerial:"",dataSN:[],doModel:{stock_out_items:[]}}},methods:{async setStepper(){let e=await JSON.parse(localStorage.getItem("progress"));this.stepper_menu[0].complete=e[0].status,this.stepper_menu[0].link=this.stepper_menu[0].link+e[0].idQT,this.stepper_menu[1].complete=e[1].status,this.stepper_menu[1].link=this.stepper_menu[1].link+e[1].idQT,this.stepper_menu[2].complete=e[2].status,this.stepper_menu[2].link=this.stepper_menu[2].link+e[2].idPL,this.stepper_menu[3].complete=e[3].status,this.stepper_menu[3].link=this.stepper_menu[3].link+e[3].idQT,this.stepper_menu[4].complete=e[4].status,this.stepper_menu[4].link=this.stepper_menu[4].link+e[4].idQT,this.stepper_menu[5].complete=e[5].status,this.stepper_menu[5].link=this.stepper_menu[5].link+e[5].idSO,this.stepper_menu[6].complete=e[6].status,this.stepper_menu[6].link=this.stepper_menu[6].link+e[6].idSO},formatDateTime(e){const s=new Date(e),o=s.getDate().toString().padStart(2,"0"),n=(s.getMonth()+1).toString().padStart(2,"0"),a=s.getFullYear().toString().slice(-2),i=s.getHours().toString().padStart(2,"0"),S=s.getMinutes().toString().padStart(2,"0"),w=s.getSeconds().toString().padStart(2,"0");return`${o}/${n}/${a} ${i}:${S}:${w}`},formatCurrency(e){return e?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(e):"Rp.0"},handleFileChange1(e){this.file1=e.target.files[0]},handleFileChange2(e){this.file2=e.target.files[0]},async CheckStepper(){this.aprove=!0,this.stepper_menu[2].complete=!0,this.stepper_menu[3].complete=!0,this.stepper_menu[4].complete=!0,this.stepper_menu[5].complete=!0,this.stepper_menu[2].link="/sales-order/detail/"+ne.data_profit.pl_id},async filterDataforTable(){const e=["createdAt","updatedAt","history","vendor_id","quotation_id","vendor_name","vendor_pic_name","vendor_pic_email","vendor_pic_id","inv_vendor_attachment","so_id","project_id","receive_type","po_id"],s=await re.data_po.map(o=>Object.fromEntries(Object.entries(o).filter(([a])=>!e.includes(a))));for(let o in s)s[o].total=this.formatCurrency(s[o].total);return s},ModalSerial(e){this.isModalOpen=!0,this.indexSerial=e,console.log(e),c=[],console.log(c)},ScanSerial(e){if(this.formserial!=="")if(this.dataPO.purchaseOrderItems[e].serial_numbers){c=this.dataPO.purchaseOrderItems[e].serial_numbers,c.push(this.formserial);let s=c;this.dataPO.purchaseOrderItems[e].serial_numbers=s}else{c.push(this.formserial);let s=c;this.dataPO.purchaseOrderItems[e].serial_numbers=s}this.formserial=O(""),console.log(this.dataPO)},removeItem(e,s){console.log(this.dataPO.purchaseOrderItems[this.indexSerial].serial_numbers),this.dataPO.purchaseOrderItems[this.indexSerial].serial_numbers=this.dataPO.purchaseOrderItems[this.indexSerial].serial_numbers.filter(o=>o!==e)},EnterSerial(e){if(this.formserial!=="")if(this.dataPO.purchaseOrderItems[e].serial_numbers){c=this.dataPO.purchaseOrderItems[e].serial_numbers,c.push(this.formserial);let s=c;this.dataPO.purchaseOrderItems[e].serial_numbers=s}else{c.push(this.formserial);let s=c;this.dataPO.purchaseOrderItems[e].serial_numbers=s}this.formserial=O(""),console.log(this.dataPO)},async SaveData(){let e=await this.mappingForSave(this.stock_out_temp);this.doModel.stock_out_items=e,this.doModel.so_id=this.$route.params.id,console.log(this.doModel),D.PostData(this.doModel)},async mappingForSave(e){return(await e.map(o=>{const n=o.receive_items.filter(a=>a.receive_item_serials_json.some(i=>i.selected)).map(a=>({product_id:a.product_id,product_number:a.product_number,uom:a.uom,serial_numbers:a.receive_item_serials_json.filter(i=>i.selected).map(i=>i.serial)}));return{po_id:o.po_id,items_out:n}})).filter(function(o){return o.items_out.length>0})},ModalShow(e){console.log(e),this.isModalOpen=!0,this.detailOrder=e},closeModal(){this.isModalOpen=!1},async mappingData(){},handleSelectAll(e,s){if(console.log(e),e.selectedAll)for(let o in e.receive_item_serials_json)e.receive_item_serials_json[o].hasOwnProperty("selected")&&(e.receive_item_serials_json[o].selected=!0);else for(let o in e.receive_item_serials_json)e.receive_item_serials_json[o].hasOwnProperty("selected")&&(e.receive_item_serials_json[o].selected=!1)},selectedSingle(e,s,o,n){s.selected||(e.selectedAll=!1)},replaceObjectById(e,s,o){var n=!1,a=e.map(function(i){return i.rg_id===s?(n=!0,o):i});return n||a.push(o),a},SaveDataTotemp(){this.stock_out_temp.length!=0?this.stock_out_temp=this.replaceObjectById(this.stock_out_temp,this.detailOrder.rg_id,this.detailOrder):this.stock_out_temp.push(this.detailOrder),console.log(this.stock_out_temp),this.isModalOpen=!1}},async created(){this.loading=!0,await this.setStepper(),await T.listSO(this.$route.params.id),await D.CheckSerial(this.$route.params.id),this.dataSN=await D.dataSerial,this.dataRG=await T.lisBy_so;for(let e in this.dataRG)for(let s in this.dataRG[e].receive_items){this.dataRG[e].receive_items[s].selectedAll=!0,this.dataRG[e].receive_items[s].receive_item_serials_json=[];for(let o in this.dataRG[e].receive_items[s].receive_item_serials){let n=this.dataRG[e].receive_items[s].receive_item_serials[o],a;this.dataSN.includes(n)&&(a={serial:n,disable:!0}),this.dataRG[e].receive_items[s].receive_item_serials_json.push(a)}}this.so_id=this.$route.params.id,this.loading=!1,console.log(this.dataRG)}},h=e=>(Q("data-v-5a37e942"),e=e(),U(),e),ce={class:"flex gap-5"},pe={class:"bg-white px-5 py-5 flex justify-between mr-10"},ue=h(()=>t("div",null,[t("h1",{class:"font-bold text-lg"},"# Select Product items for Process to Delivery")],-1)),_e={class:"h-[500px] px-10 py-10 w-[1000px] bg-slate-200 overflow-y-auto"},me={class:"flex justify-center items-center gap-3"},he={class:"w-full"},fe={class:"bg-white rounded px-5 py-5 shadow-md flex justify-between gap-5"},ve={class:"w-full bg-white py-3 shadow px-2 rounded"},ye=h(()=>t("b",null,"Part Number #: ",-1)),ge={class:"w-full bg-white py-3 shadow px-2 rounded"},be=h(()=>t("b",null,"UOM #: ",-1)),ke={class:"px-5 py-2"},Se={class:"bg-gray-100 px-5 py-2 flex gap-3"},we=["onUpdate:modelValue","onChange"],xe=h(()=>t("b",null,"Select All",-1)),Oe=h(()=>t("div",{class:"border-b w-fit px-5 py-2 mt-1"},"Serial Number",-1)),De={class:"w-full h-[150px] overflow-y-scroll px-10"},Me={class:"w-full grid grid-cols-3 gap-2 mt-5"},Ie=["onUpdate:modelValue","onChange","disabled"],Pe={class:"w-full"},Ce={key:0,class:"border-t w-full"},je=h(()=>t("div",{class:"flex mt-10 justify-end"},null,-1)),Te={class:"px-20 py-10 w-full flex justify-center items-center"},Re={class:"w-full px-10 py-10 bg-white"},Ve={class:"w-full grid grid-cols-2 gap-5 mt-5 bg-white"},Be={class:"w-full flex justify-end"},Ge={class:"w-full mt-10"},Le={class:"relative overflow-x-auto"},Ae={class:"w-full text-sm text-left rtl:text-right text-gray-500 mt-2"},Fe=h(()=>t("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3"}," Receive Date "),t("th",{scope:"col",class:"px-6 py-3"}," Vendor "),t("th",{scope:"col",class:"px-6 py-3"}," PO Number "),t("th",{scope:"col",class:"px-6 py-3"}," Vendor DO "),t("th",{scope:"col",class:"px-6 py-3"}," Total In "),t("th",{scope:"col",class:"px-6 py-3"}," # ")])],-1)),Ne={class:"px-6 py-4 text-xs"},Qe={class:"mb-2"},Ue={class:"px-6 py-4"},$e={class:"px-6 py-4"},qe={class:"px-6 py-4"},ze={class:"px-6 py-4"},Ee={class:"px-6 py-4"};function He(e,s,o,n,a,i){const S=_("Loading"),w=_("ButtonLink"),R=_("MenuCard"),x=_("Button"),V=_("Modal"),B=_("Stepper"),G=_("InputField"),L=_("Default");return a.loading?(d(),I(S,{key:0})):(d(),I(L,{key:1},{default:v(()=>[m(R,{menuLabel:"Delivery Order"},{default:v(()=>[t("div",ce,[m(w,{type:"secondary",size:"small",icon_name:"Eye",icon_position:"left",to:"/list-delivery/"+a.so_id},{default:v(()=>[g(" List Delivery")]),_:1},8,["to"])])]),_:1}),m(V,{show:a.isModalOpen,modalType:"primary",modalLabel:"Received Product Items",onCloseModal:i.closeModal,closeModalIcon:!1},{default:v(()=>[t("div",pe,[ue,m(x,{type:"success",onClick:s[0]||(s[0]=l=>i.SaveDataTotemp()),class:"w-fit h-fit",icon_position:"left",size:"small",icon_name:"Check"})]),t("div",_e,[t("div",me,[t("div",he,[(d(!0),p(k,null,b(a.detailOrder.receive_items,(l,f)=>(d(),p("div",{class:"w-full bg-white shadow-md rounded-lg mb-5 pb-5",key:f},[t("div",fe,[t("div",ve,[ye,g(" "+u(l.product_number),1)]),t("div",ge,[be,g(u(l.uom),1)])]),t("div",ke,[t("div",Se,[C(t("input",{type:"checkbox","onUpdate:modelValue":r=>l.selectedAll=r,onChange:r=>i.handleSelectAll(l,f),class:"form-checkbox h-4 w-4 text-indigo-600 transition duration-150 ease-in-out"},null,40,we),[[P,l.selectedAll]]),xe]),Oe,t("div",De,[t("div",Me,[(d(!0),p(k,null,b(l.receive_item_serials_json,(r,y)=>(d(),p("div",{class:"bg-white px-3 py-2 shadow-md flex gap-3",key:y},[r.hasOwnProperty("selected")?C((d(),p("input",{key:0,type:"checkbox","onUpdate:modelValue":M=>r.selected=M,onChange:M=>i.selectedSingle(l,r,f,y),class:"form-checkbox h-4 w-4 text-indigo-600 transition duration-150 ease-in-out",disabled:r.disable},null,40,Ie)),[[P,r.selected]]):j("",!0),t("div",Pe,[t("h1",null,u(r.serial),1),r.disable?(d(),p("h1",Ce,"Delivered "+u(),1)):j("",!0)])]))),128))])])])]))),128))])]),je])]),_:1},8,["show","onCloseModal"]),t("div",Te,[m(B,{menu:a.stepper_menu},null,8,["menu"])]),t("div",Re,[t("div",Ve,[m(G,{type:"date",class:"w-full",placeholder:"Receive Date",modelValue:a.doModel.do_date,"onUpdate:modelValue":s[1]||(s[1]=l=>a.doModel.do_date=l)},null,8,["modelValue"]),t("div",Be,[m(x,{type:"success",onClick:s[2]||(s[2]=l=>i.SaveData()),class:"w-fit h-fit",icon_position:"left",size:"small",icon_name:"Truck"},{default:v(()=>[g(" Process To Delivery ")]),_:1})])]),t("div",Ge,[t("div",Le,[t("table",Ae,[Fe,t("tbody",null,[(d(!0),p(k,null,b(a.dataRG,(l,f)=>(d(),p("tr",{class:"bg-white border-b",key:f},[t("td",Ne,[t("h1",Qe,u(i.formatDateTime(l.receive_date)),1)]),t("td",Ue,u(l.vendor_name),1),t("td",$e,u(l.po_number),1),t("td",qe,u(l.vendor_do_number),1),t("td",ze,[(d(!0),p(k,null,b(l.total_quantity_in,(r,y)=>(d(),p("h1",{key:y},u(r.quantity+"   "+r.uom+"   "),1))),128))]),t("td",Ee,[m(x,{type:"secondary",onClick:r=>i.ModalShow(l),class:"w-fit h-fit",icon_position:"left",size:"small",icon_name:"SearchCheck"},null,8,["onClick"])])]))),128))])])])])])]),_:1}))}const ft=N(de,[["render",He],["__scopeId","data-v-5a37e942"]]);export{ft as default};
