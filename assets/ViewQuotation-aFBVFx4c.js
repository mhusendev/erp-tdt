import{D as R}from"./Default-UzTWWqk9.js";import{_ as N}from"./Icon-rtOuHIS6.js";import{u as j,x as M,m as U,y as J,_ as G,f as L,c as f,w as n,r as u,o as l,b as _,a as e,d as c,j as h,t as a,g as H,l as K,F as W,p as X,k as Y}from"./index-2Xl9qFv7.js";import{u as Z}from"./projects-m_BtDv-_.js";import{u as $}from"./products-KWUgHVH5.js";import{u as tt}from"./brands-phqYSftc.js";import{u as et}from"./quotations-DO3D_tSp.js";import{u as st}from"./profits-DD-uQzfp.js";import{I as ot}from"./InputField-eKlKr605.js";import{M as at}from"./MenuCard-Cm1nNJYU.js";import{B as it}from"./ButtonLink-xY7BTdTe.js";import{B as lt}from"./Button-_saYDuqz.js";import{L as rt}from"./Loading-bud4hAA4.js";import{s as nt}from"./default.css_vue_type_style_index_0_src_true_lang-U16oWYK-.js";import{D as ct}from"./DataTable-yeLKldhm.js";import{M as dt}from"./Modal-ZMIHFB3R.js";import{T as pt}from"./TextArea-KW4ixcr0.js";import{T as ut}from"./TextCurrency-fK0DUXJx.js";import{S as _t}from"./Stepper-iYhSeoBN.js";import"./Pagination-9Wn2p13Z.js";var ht={VITE_API_BASE_URL:"https://auth-erp-tdt.cws.co.id/erp-tdt/api",VITE_API_BASE_URL2:"https://backend-dani-erp-tdt.cws.co.id/erp-tdt/api",VITE_API_AUTH_URL:"https://backend-keycloak-erp-tdt.cws.co.id/keycloak/api",VITE_APP_MODE:"dev",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const A=j(),mt=ht,ft={getAll:"/module-progress?quotation_id="},gt={headers:{Authorization:`Bearer ${A.access_token}`}},bt=M({id:"module-progress",state:()=>U({data_progress:[]}),getters:{},actions:{async getData(t){try{const o=await J.get(mt.VITE_API_BASE_URL2+ft.getAll+t,gt);this.data_progress=o.data.data}catch(o){A.sessionFail(o.response.data.message),console.log(o)}}}});Z();const y=$(),T=tt(),m=et();st();const q=bt(),yt={components:{TextCurrency:ut,Default:R,Icon:N,MenuCard:at,ButtonLink:it,Button:lt,Loading:rt,InputField:ot,DataTable:ct,Modal:dt,Multiselect:nt,TextArea:pt,Stepper:_t},data(){return{data:L(m.dataDetail),loading:!1,isPLexist:!1,stepper_menu:[{label:"QT",complete:!1,link:"/quotation/detail/"},{label:"PL",complete:!1,link:"/profit-and-loss/detail/"},{label:"SO",complete:!1,link:"/sales-order/detail/"},{label:"PO",complete:!1,link:"/purchase-order/"},{label:"RG",complete:!1,link:"/receive-list/"},{label:"DO",complete:!1,link:"/delivery-order/"},{label:"IV",complete:!1,link:"/invoice/so/"}],listQuotation:L(m.data_quotations),modelQuotation:{},uomOpt:[{label:"pcs",value:"pcs"},{label:"pack",value:"pack"},{label:"unit",value:"unit"}],term_opt:[{label:"--pilih--"},{label:"CBD"},{label:"COD"},{label:"DP"}],leadtime_opt:[{label:"--pilih--"},{label:"Indent"},{label:"Ready"}],formFields:[]}},methods:{async checkStepper(){await q.getData(this.$route.params.id);let t=await q.data_progress;t[1].status&&(this.isPLexist=!0),localStorage.setItem("progress",JSON.stringify(t))},async setStepper(){let t=await JSON.parse(localStorage.getItem("progress"));this.stepper_menu[0].complete=t[0].status,this.stepper_menu[0].link=this.stepper_menu[0].link+t[0].idQT,this.stepper_menu[1].complete=t[1].status,this.stepper_menu[1].link=this.stepper_menu[1].link+t[1].idQT,this.stepper_menu[2].complete=t[2].status,this.stepper_menu[2].link=this.stepper_menu[2].link+t[2].idPL,this.stepper_menu[3].complete=t[3].status,this.stepper_menu[3].link=this.stepper_menu[3].link+t[3].idQT,this.stepper_menu[4].complete=t[4].status,this.stepper_menu[4].link=this.stepper_menu[4].link+t[4].idQT,this.stepper_menu[5].complete=t[5].status,this.stepper_menu[5].link=this.stepper_menu[5].link+t[5].idSO,this.stepper_menu[6].complete=t[6].status,this.stepper_menu[6].link=this.stepper_menu[6].link+t[6].idSO},async Product(t){return await y.Search(t),this.products=y.dataSearch,await y.dataSearch.map(o=>({value:o.product_number,label:o.product_number}))},async Brands(t){return await T.Search(t),await T.dataSearch.map(o=>({value:o.brand_name,label:o.brand_name}))},formatPrice(t){return(t/1).toFixed(2).replace(".",",").toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")},formatCurrency(t){return t?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(t):"Rp.0"},async searchArray(t,o,d){return await t.find(x=>x[o]===d)},async fillDesc(t,o){console.log(this.formFields[t][o].value),console.log(this.products);let d=await this.searchArray(this.products,"product_number",this.formFields[t][o].value);console.log(d),d==null?(this.formFields[t][1].label="product not exist! need  select brand",this.formFields[t][1].disable=!1):(this.formFields[t][1].value="",this.formFields[t][2].value=d.product_descriptionAa,this.formFields[t][1].label="product exist! not need brand",this.formFields[t][1].disable=!0),console.log(this.formFields[t][1])},addFormField(){const t=[{name:"product_number"+(this.formFields.length+1),label:"product number ",type:"product",value:""},{name:"brand_name"+(this.formFields.length+1),label:"Select Product First ",type:"brand",value:"",disable:!0},{name:"description"+(this.formFields.length+1),label:"description ",type:"text",value:""},{name:"quantity"+(this.formFields.length+1),label:"quantity ",type:"number",value:""},{name:"uom"+(this.formFields.length+1),label:"uom ",type:"select",options:this.uomOpt,value:""},{name:"unit_price"+(this.formFields.length+1),label:"unit price ",type:"currency",value:""}];this.formFields.push(t)},exitingItems(){for(let t in this.data.quotation_items)this.addFormField(),this.formFields[t][0].value={value:this.data.quotation_items[t].product.product_number,label:this.data.quotation_items[t].product.product_number},this.formFields[t][1].disable=!0,this.formFields[t][2].value=this.data.quotation_items[t].description,this.formFields[t][3].value=this.data.quotation_items[t].quantity,this.formFields[t][4].value=this.data.quotation_items[t].uom,this.formFields[t][5].value=this.data.quotation_items[t].unit_price},async ApproveQT(){await m.approveQT(this.data.quotation_id)}},async mounted(){},async created(){this.loading=!0;let t=await this.$route.params.id;await this.checkStepper(),await this.setStepper(),console.log(t),await m.getById(t),this.data=await m.dataDetail,console.log(this.data),this.modelQuotation=await this.data,this.exitingItems(),this.loading=!1}},i=t=>(X("data-v-3db6a4ab"),t=t(),Y(),t),xt={class:"flex gap-5"},wt={key:0,class:"flex gap-3"},vt={key:1},kt={class:"px-20 py-10 w-full flex justify-center items-center"},St={class:"w-full mt-10 bg-white shadow-lg rounded-lg px-5 py-5"},Ft={class:"grid grid-cols-3 gap-5"},Pt={class:"bg-white shadow-lg px-5 py-5 rounded-lg grid grid-rows-5 gap-1"},It=i(()=>e("h1",{class:"border-b h-fit text-slate-700"},"Details",-1)),Bt={class:"flex"},Ct=i(()=>e("h1",{class:"capitalize w-32"},"customer name",-1)),Dt={class:"flex"},Lt=i(()=>e("h1",{class:"capitalize w-32"},"phone",-1)),Tt={class:"flex"},qt=i(()=>e("h1",{class:"capitalize w-32"},"Billing",-1)),At={class:"flex"},Et=i(()=>e("h1",{class:"capitalize w-32"},"shipping",-1)),Qt={class:"bg-white shadow-lg px-5 py-5 rounded-lg grid grid-rows-5 gap-1"},Vt=i(()=>e("h1",{class:"border-b text-slate-700 h-fit"},"Contact",-1)),Ot={class:"flex"},zt=i(()=>e("h1",{class:"capitalize w-32"},"contact name",-1)),Rt={class:"flex"},Nt=i(()=>e("h1",{class:"capitalize w-32"},"phone",-1)),jt={class:"flex"},Mt=i(()=>e("h1",{class:"capitalize w-32"},"email",-1)),Ut=["href"],Jt={class:"bg-white shadow-lg px-5 py-5 rounded-lg gap-1"},Gt=i(()=>e("h1",{class:"border-b h-fit text-slate-700 h-fit"},"Status",-1)),Ht={class:"flex justify-center h-full items-center"},Kt={key:0,class:"text-5xl text-center text-xl"},Wt={key:1,class:"text-5xl text-center bg-red-600 text-white px-3 py-2 rounded"},Xt={key:2,class:"text-3xl text-center bg-green-600 text-white px-3 py-2 rounded"},Yt={class:"w-full bg-white px-5 py-5 mt-10"},Zt={class:"w-full flex justify-end"},$t={class:"w-full mt-10"},te={class:"relative overflow-x-auto"},ee=i(()=>e("div",{class:"w-full bg-gray-50 text-gray-700 px-5 py-3 font-semibold"}," List Items ",-1)),se={class:"w-full text-sm text-left rtl:text-right text-gray-500 mt-2"},oe=i(()=>e("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3"}," Product "),e("th",{scope:"col",class:"px-6 py-3"}," Qty "),e("th",{scope:"col",class:"px-6 py-3 text-center"}," Unit Price "),e("th",{scope:"col",class:"px-6 py-3 text-center"}," Total Price ")])],-1)),ae={class:"px-6 py-4 text-xs"},ie={class:"mb-2"},le={class:""},re={class:"px-6 py-4"},ne={class:"px-6 py-4 text-right"},ce={class:"px-6 py-4 text-right"},de={class:"bg-white border-b"},pe=i(()=>e("td",{colspan:"3",class:"px-6 py-4 text-right"},[e("b",null," Subtotal")],-1)),ue={class:"px-6 py-4 text-right"},_e={class:"bg-white border-b"},he=i(()=>e("td",{colspan:"3",class:"px-6 py-4 text-right"},[e("b",null," PPN")],-1)),me={class:"px-6 py-4 text-right"},fe={class:"bg-white border-b"},ge=i(()=>e("td",{colspan:"3",class:"px-6 py-4 text-right"},[e("b",null," Total")],-1)),be={class:"px-6 py-4 text-right"};function ye(t,o,d,x,s,p){const E=u("Loading"),g=u("ButtonLink"),b=u("Button"),Q=u("MenuCard"),V=u("Stepper"),O=u("Default");return s.loading?(l(),f(E,{key:0})):(l(),f(O,{key:1},{default:n(()=>{var w,v,k,S,F,P,I,B;return[_(Q,{menuLabel:s.data.quotation_number},{default:n(()=>[e("div",xt,[_(g,{type:"secondary",size:"small",icon_name:"ArrowBigLeft",icon_position:"left",link:!0,to:"/projects/detail/"+s.data.project_id},null,8,["to"]),s.data.status==1?(l(),c("div",wt,[_(b,{type:"success",onClick:p.ApproveQT,icon_position:"left",size:"small",icon_name:"Check"},{default:n(()=>[h(" Success ")]),_:1},8,["onClick"]),_(b,{type:"danger",onClick:t.submitForm,icon_position:"left",size:"small",icon_name:"Ban"},{default:n(()=>[h(" Cancel ")]),_:1},8,["onClick"])])):(l(),c("div",vt,[s.isPLexist?(l(),f(g,{key:0,type:"secondary",to:"/profit-and-loss/detail/"+s.data.quotation_id},{default:n(()=>[h(" Profit & Loss ")]),_:1},8,["to"])):(l(),f(g,{key:1,type:"primary",icon_position:"left",size:"small",icon_name:"Plus",to:"/quotation/pl/"+s.data.quotation_id},{default:n(()=>[h("New Profit & Loss ")]),_:1},8,["to"]))]))])]),_:1},8,["menuLabel"]),e("div",kt,[_(V,{menu:s.stepper_menu},null,8,["menu"])]),e("div",St,[e("div",Ft,[e("div",Pt,[It,e("div",Bt,[Ct,e("p",null,":  "+a((w=s.data.customer)==null?void 0:w.customer_name),1)]),e("div",Dt,[Lt,e("p",null,":  "+a((v=s.data.customer)==null?void 0:v.telephone),1)]),e("div",Tt,[qt,e("p",null,":  "+a((k=s.data.customer)==null?void 0:k.customer_billing_address),1)]),e("div",At,[Et,e("p",null,":  "+a((S=s.data.customer)==null?void 0:S.customer_shipping_address),1)])]),e("div",Qt,[Vt,e("div",Ot,[zt,e("p",null,":  "+a((F=s.data.customer_pic)==null?void 0:F.contact_name),1)]),e("div",Rt,[Nt,e("p",null,":  "+a((P=s.data.customer_pic)==null?void 0:P.mobile_phone),1)]),e("div",jt,[Mt,e("p",null,":  "+a((I=s.data.customer_pic)==null?void 0:I.email),1)]),e("a",{href:"https://wa.me/"+((B=s.data.customer_pic)==null?void 0:B.mobile_phone),target:"_blank",class:"bg-green-600 flex justify-center rounded-full items-center text-white py-2"},"open whatsapp",8,Ut)]),e("div",Jt,[Gt,e("div",Ht,[s.data.status==1?(l(),c("h1",Kt,"On Submission")):s.data.status==0?(l(),c("h1",Wt,"Rejected")):s.data.status==2?(l(),c("h1",Xt," Approved ")):H("",!0)])])])]),e("div",Yt,[e("div",Zt,[e("div",null,[_(b,{type:"secondary",class:"w-fit h-fit",onClick:t.submitForm,icon_position:"left",size:"small",icon_name:"Download"},{default:n(()=>[h(" Download Quotation ")]),_:1},8,["onClick"])])]),e("div",$t,[e("div",te,[ee,e("table",se,[oe,e("tbody",null,[(l(!0),c(W,null,K(s.data.quotation_items,(r,z)=>{var C,D;return l(),c("tr",{class:"bg-white border-b",key:z},[e("td",ae,[e("h1",ie,a((C=r.product)==null?void 0:C.product_number),1),e("h1",le,a((D=r.product)==null?void 0:D.product_description),1)]),e("td",re,a(r.quantity+" "+r.uom),1),e("td",ne,a(p.formatCurrency(r==null?void 0:r.unit_price)),1),e("td",ce,a(p.formatCurrency(r==null?void 0:r.total_price)),1)])}),128)),e("tr",de,[pe,e("td",ue,a(p.formatCurrency(s.data.grand_total)),1)]),e("tr",_e,[he,e("td",me,a(p.formatCurrency(s.data.grand_total*s.data.ppn/100)),1)]),e("tr",fe,[ge,e("td",be,a(p.formatCurrency(s.data.grand_total*s.data.ppn/100+s.data.grand_total)),1)])])])])])])]}),_:1}))}const Re=G(yt,[["render",ye],["__scopeId","data-v-3db6a4ab"]]);export{Re as default};
