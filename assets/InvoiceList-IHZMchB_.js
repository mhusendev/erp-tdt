import{D as L}from"./Default-LfTR1VjV.js";import{_ as A}from"./Icon-aDk_KqCg.js";import{f as M,r as _,o as d,b as T,w as I,a as u,d as t,c as f,l as P,F as j,t as c,j as D,s as N,h as F,p as V,k as Q}from"./index-3VIsnPTN.js";import{u as R}from"./projects-bfIeDXOj.js";import{u as z}from"./quotations-DKV3vdtf.js";import{u as E}from"./purchase-orders-Dw_HkDBj.js";import{u as $}from"./profits-CfWhkcUx.js";import{u as U}from"./sales-orders-tqon6XcB.js";import{u as q}from"./receive-goods-iVpOPdm8.js";import{u as G}from"./delivery-order-bf6aIy0W.js";import{u as H}from"./invoice-ks8ThVXQ.js";import{I as J}from"./InputField-7BnCext7.js";import{M as Y}from"./MenuCard-iMsFtknn.js";import{B as K}from"./ButtonLink-9IpDKwVO.js";import{B as W}from"./Button-fTGUJeva.js";import{L as X}from"./Loading-sJ64mZn0.js";import{s as Z}from"./default.css_vue_type_style_index_0_src_true_lang-7xlbMjmG.js";import{D as ee}from"./DataTable-aefNwkh5.js";import{M as te}from"./Modal-eH2qysXC.js";import{T as se}from"./TextArea-Y7UasRCk.js";import{T as oe}from"./TextCurrency-KJDE1gIN.js";import{S as ie}from"./Stepper-DyQ-U5va.js";import{_ as ae}from"./_plugin-vue_export-helper-x3n3nnut.js";import"./Pagination-pdYa9xhx.js";R();z();const re=E();$();U();q();G();const C=H();let n=[];const le={components:{TextCurrency:oe,Default:L,Icon:A,MenuCard:Y,ButtonLink:K,Button:W,Loading:X,InputField:J,DataTable:ee,Modal:te,Multiselect:Z,TextArea:se,Stepper:ie},data(){return{vendorDOModel:{},body:[],detailOrder:{},temp_data_invoice:[],manualChecked:!0,aprove:!1,stepper_menu:[{label:"QT",complete:!1,link:"/quotation/detail/"},{label:"PL",complete:!1,link:"/profit-and-loss/detail/"},{label:"SO",complete:!1,link:"/sales-order/detail/"},{label:"PO",complete:!1,link:"/purchase-order/"},{label:"RG",complete:!1,link:"/receive-list/"},{label:"DO",complete:!1,link:"/delivery-order/"},{label:"IV",complete:!1,link:"/invoice/so/"}],file1:null,file2:null,dataPO:{},dataInvoice:[],loading:!1,isModalOpen:!1,so_id:"",formserial:M(""),indexSerial:"",dataSN:[],doModel:{stock_out_items:[]}}},methods:{async setStepper(){var s,o,r,i,a,h,m,b,v,x,O,S,y,g;let e=await JSON.parse(localStorage.getItem("progress"));e&&(this.stepper_menu[0].complete=(s=e[0])==null?void 0:s.status,this.stepper_menu[0].link=this.stepper_menu[0].link+((o=e[0])==null?void 0:o.idQT),this.stepper_menu[1].complete=(r=e[1])==null?void 0:r.status,this.stepper_menu[1].link=this.stepper_menu[1].link+((i=e[1])==null?void 0:i.idQT),this.stepper_menu[2].complete=(a=e[2])==null?void 0:a.status,this.stepper_menu[2].link=this.stepper_menu[2].link+((h=e[2])==null?void 0:h.idPL),this.stepper_menu[3].complete=(m=e[3])==null?void 0:m.status,this.stepper_menu[3].link=this.stepper_menu[3].link+((b=e[3])==null?void 0:b.idQT),this.stepper_menu[4].complete=(v=e[4])==null?void 0:v.status,this.stepper_menu[4].link=this.stepper_menu[4].link+((x=e[4])==null?void 0:x.idQT),this.stepper_menu[5].complete=(O=e[5])==null?void 0:O.status,this.stepper_menu[5].link=this.stepper_menu[5].link+((S=e[5])==null?void 0:S.idSO),this.stepper_menu[6].complete=(y=e[6])==null?void 0:y.status,this.stepper_menu[6].link=this.stepper_menu[6].link+((g=e[6])==null?void 0:g.idSO))},formatDateTime(e){const s=new Date(e),o=s.getDate().toString().padStart(2,"0"),r=(s.getMonth()+1).toString().padStart(2,"0"),i=s.getFullYear().toString().slice(-2),a=s.getHours().toString().padStart(2,"0"),h=s.getMinutes().toString().padStart(2,"0"),m=s.getSeconds().toString().padStart(2,"0");return`${o}/${r}/${i} ${a}:${h}:${m}`},formatCurrency(e){return e?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(e):"Rp.0"},handleFileChange1(e){this.file1=e.target.files[0]},handleFileChange2(e){this.file2=e.target.files[0]},async filterDataforTable(){const e=["createdAt","updatedAt","history","vendor_id","quotation_id","vendor_name","vendor_pic_name","vendor_pic_email","vendor_pic_id","inv_vendor_attachment","so_id","project_id","receive_type","po_id"],s=await re.data_po.map(o=>Object.fromEntries(Object.entries(o).filter(([i])=>!e.includes(i))));for(let o in s)s[o].total=this.formatCurrency(s[o].total);return s},ModalSerial(e){this.isModalOpen=!0,this.indexSerial=e,console.log(e),n=[],console.log(n)},ScanSerial(e){if(this.formserial!=="")if(this.dataPO.purchaseOrderItems[e].serial_numbers){n=this.dataPO.purchaseOrderItems[e].serial_numbers,n.push(this.formserial);let s=n;this.dataPO.purchaseOrderItems[e].serial_numbers=s}else{n.push(this.formserial);let s=n;this.dataPO.purchaseOrderItems[e].serial_numbers=s}this.formserial=M(""),console.log(this.dataPO)},removeItem(e,s){console.log(this.dataPO.purchaseOrderItems[this.indexSerial].serial_numbers),this.dataPO.purchaseOrderItems[this.indexSerial].serial_numbers=this.dataPO.purchaseOrderItems[this.indexSerial].serial_numbers.filter(o=>o!==e)},EnterSerial(e){if(this.formserial!=="")if(this.dataPO.purchaseOrderItems[e].serial_numbers){n=this.dataPO.purchaseOrderItems[e].serial_numbers,n.push(this.formserial);let s=n;this.dataPO.purchaseOrderItems[e].serial_numbers=s}else{n.push(this.formserial);let s=n;this.dataPO.purchaseOrderItems[e].serial_numbers=s}this.formserial=M(""),console.log(this.dataPO)},async SaveData(){let e=[];for(let o in this.temp_data_invoice)for(let r in this.temp_data_invoice[o].delivery_items)this.temp_data_invoice[o].delivery_items[r].selectedAll&&e.push(this.temp_data_invoice[o].delivery_items[r].doItem_id);let s={doItems_id:e,so_id:this.$route.params.id};C.PostData(s)},async mappingForSave(e){return(await e.map(o=>{const r=o.receive_items.filter(i=>i.receive_item_serials_json.some(a=>a.selected)).map(i=>({product_id:i.product_id,product_number:i.product_number,uom:i.uom,serial_numbers:i.receive_item_serials_json.filter(a=>a.selected).map(a=>a.serial)}));return{po_id:o.po_id,items_out:r}})).filter(function(o){return o.items_out.length>0})},ModalShow(e){console.log(e),this.isModalOpen=!0,this.detailOrder=e},closeModal(){this.isModalOpen=!1},async mappingData(){},handleSelectAll(e,s){if(console.log(e),e.selectedAll)for(let o in e.receive_item_serials_json)e.receive_item_serials_json[o].selected=!0;else for(let o in e.receive_item_serials_json)e.receive_item_serials_json[o].selected=!1},selectedSingle(e,s,o,r){s.selected||(e.selectedAll=!1)},replaceObjectById(e,s,o){var r=!1,i=e.map(function(a){return a.rg_id===s?(r=!0,o):a});return r||i.push(o),i},SaveDataTotemp(){this.temp_data_invoice.length!=0?this.temp_data_invoice=this.replaceObjectById(this.temp_data_invoice,this.detailOrder.rg_id,this.detailOrder):this.temp_data_invoice.push(this.detailOrder),console.log(this.temp_data_invoice),this.isModalOpen=!1}},async created(){this.loading=!0,await this.setStepper(),await C.listBySO(this.$route.params.id),this.dataInvoice=await C.lisBy_so,this.so_id=this.$route.params.id,this.loading=!1,console.log(this.dataInvoice)}},p=e=>(V("data-v-657c08fb"),e=e(),Q(),e),ne={class:"flex gap-5"},de={class:"bg-white px-5 py-5 flex justify-between mr-10"},ce=p(()=>t("div",null,[t("h1",{class:"font-bold text-lg"},"# Select Product items for Invoice")],-1)),pe={class:"h-[700px] px-10 py-10 w-[1000px] bg-slate-200 overflow-y-auto"},me={class:"flex justify-center items-center gap-3"},_e={class:"w-full"},ue={class:"bg-gray-100 px-5 py-2 flex gap-3"},he=["onUpdate:modelValue","onChange"],fe=p(()=>t("b",null,"#",-1)),ve={class:"bg-white rounded px-5 py-5 shadow-md flex justify-between gap-5"},ye={class:"w-full bg-white py-3 shadow px-2 rounded"},ge=p(()=>t("b",null,"Part Number #: ",-1)),be={class:"w-full bg-white py-3 shadow px-2 rounded"},xe=p(()=>t("b",null,"UOM #: ",-1)),Oe={class:"px-5 py-2"},Se=p(()=>t("div",{class:"border-b w-fit px-5 py-2 mt-1"},"Serial Number",-1)),we={class:"w-full h-[150px] overflow-y-scroll px-10"},ke={class:"w-full grid grid-cols-3 gap-2 mt-5"},Ie=p(()=>t("div",{class:"flex mt-10 justify-end"},null,-1)),De={class:"px-20 py-10 w-full flex justify-center items-center"},Me={class:"w-full px-10 py-10 bg-white"},Pe={class:"w-full grid grid-cols-2 gap-5 mt-5 bg-white"},je={class:"w-full"},Ce={class:"font-semibold text-lg px-5"},Te={class:"text-md px-5"},Be=p(()=>t("b",null,"SO Number #:",-1)),Le={class:"w-full mt-10"},Ae={class:"flex justify-end"},Ne={class:"relative overflow-x-auto"},Fe={class:"w-full text-sm text-left rtl:text-right text-gray-500 mt-2"},Ve=p(()=>t("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3"}," Customer "),t("th",{scope:"col",class:"px-6 py-3"}," Invoice Number "),t("th",{scope:"col",class:"px-6 py-3"}," Date "),t("th",{scope:"col",class:"px-6 py-3"}," # ")])],-1)),Qe={class:"px-6 py-4 text-xs"},Re={class:"mb-2"},ze={class:"px-6 py-4"},Ee={class:"px-6 py-4"},$e={class:"px-6 py-4 flex justify-center"};function Ue(e,s,o,r,i,a){const h=_("Loading"),m=_("ButtonLink"),b=_("MenuCard"),v=_("Button"),x=_("Modal"),O=_("Stepper"),S=_("Default");return i.loading?(d(),T(h,{key:0})):(d(),T(S,{key:1},{default:I(()=>{var y,g;return[u(b,{menuLabel:"List Invoice"},{default:I(()=>[t("div",ne,[u(m,{type:"secondary",size:"small",icon_name:"ArrowLeft",icon_position:"left",to:"/list-delivery/"+i.so_id},null,8,["to"])])]),_:1}),u(x,{show:i.isModalOpen,modalType:"primary",modalLabel:"Product Items ",onCloseModal:a.closeModal,closeModalIcon:!1},{default:I(()=>[t("div",de,[ce,u(v,{type:"success",onClick:s[0]||(s[0]=l=>a.SaveDataTotemp()),class:"w-fit h-fit",icon_position:"left",size:"small",icon_name:"Check"})]),t("div",pe,[t("div",me,[t("div",_e,[(d(!0),f(j,null,P(i.detailOrder.delivery_items,(l,w)=>(d(),f("div",{class:"w-full bg-white shadow-md rounded-lg mb-5",key:w},[t("div",ue,[F(t("input",{type:"checkbox","onUpdate:modelValue":k=>l.selectedAll=k,onChange:k=>a.handleSelectAll(l,w),class:"form-checkbox h-4 w-4 text-indigo-600 transition duration-150 ease-in-out"},null,40,he),[[N,l.selectedAll]]),fe]),t("div",ve,[t("div",ye,[ge,D(" "+c(l.product_number),1)]),t("div",be,[xe,D(c(l.uom),1)])]),t("div",Oe,[Se,t("div",we,[t("div",ke,[(d(!0),f(j,null,P(l.delivery_item_serials,(k,B)=>(d(),f("div",{class:"bg-gray-200 px-3 py-2 shadow-md flex gap-3",key:B},c(k),1))),128))])])])]))),128))])]),Ie])]),_:1},8,["show","onCloseModal"]),t("div",De,[u(O,{menu:i.stepper_menu},null,8,["menu"])]),t("div",Me,[t("div",Pe,[t("div",je,[t("h1",Ce,c((y=i.dataInvoice[0])==null?void 0:y.customer_name),1),t("h1",Te,[Be,D(" "+c((g=i.dataInvoice[0])==null?void 0:g.so_number),1)])])]),t("div",Le,[t("div",Ae,[u(v,{type:"success",onClick:s[1]||(s[1]=l=>a.SaveData()),class:"w-fit h-fit",icon_position:"left",size:"small",icon_name:"Check"},{default:I(()=>[D(" Project Complete ")]),_:1})]),t("div",Ne,[t("table",Fe,[Ve,t("tbody",null,[(d(!0),f(j,null,P(i.dataInvoice,(l,w)=>(d(),f("tr",{class:"bg-white border-b",key:w},[t("td",Qe,[t("h1",Re,c(l.customer_name),1)]),t("td",ze,c(l.invoice_number),1),t("td",Ee,c(a.formatDateTime(l.invoice_date)),1),t("td",$e,[u(m,{type:"secondary",size:"small",icon_name:"Eye",icon_position:"left",to:"/invoice/detail/"+l.inv_info_id},null,8,["to"])])]))),128))])])])])])]}),_:1}))}const ht=ae(le,[["render",Ue],["__scopeId","data-v-657c08fb"]]);export{ht as default};
